<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>Блатной мир — текстовый квест</title>
<style>
  body {
    background-color: #1e1e1e;
    color: #d4d4d4;
    font-family: "Courier New", monospace;
    max-width: 600px;
    margin: 30px auto;
    padding: 20px;
    border: 3px solid #444;
    border-radius: 10px;
  }
  h1 {
    color: #ff6f61;
    text-align: center;
  }
  .question {
    margin: 20px 0;
  }
  button {
    background-color: #ff6f61;
    border: none;
    padding: 10px 18px;
    color: white;
    font-size: 16px;
    margin: 5px;
    cursor: pointer;
    border-radius: 5px;
  }
  button:hover {
    background-color: #ff4b3a;
  }
  #story {
    white-space: pre-line;
    font-size: 18px;
  }
</style>
</head>
<body>

<h1>Блатной мир</h1>
<div id="story">Добро пожаловать в игру "Блатной мир". Ты — порядочный арестант, который пытается выжить и сохранить честь в сложных условиях тюремного быта. Твои решения повлияют на судьбу. Жми "Начать", чтобы начать игру.</div>

<div id="choices"></div>

<script>
const storyElem = document.getElementById("story");
const choicesElem = document.getElementById("choices");

let state = {
  honor: 5,  // уровень чести (0-10)
  respect: 5, // уважение в тюремном мире (0-10)
  freedomChance: 0 // шанс выйти на свободу
};

function updateStory(text, choices) {
  storyElem.textContent = text;
  choicesElem.innerHTML = "";
  choices.forEach(choice => {
    const btn = document.createElement("button");
    btn.textContent = choice.text;
    btn.onclick = () => choice.handler();
    choicesElem.appendChild(btn);
  });
}

function startGame() {
  state = { honor: 5, respect: 5, freedomChance: 0 };
  intro();
}

function intro() {
  updateStory(
`Ты только что попал в тюрьму. Мир здесь суров, и тебе придется выбирать — идти по пути порядочного арестанта или пытаться выжить любыми способами.

Твои базовые характеристики:
  Честь: ${state.honor}
  Уважение: ${state.respect}

Что будешь делать в первую ночь?`,
  [
    { text: "Попробовать завести друзей среди арестантов", handler: nightFriends },
    { text: "Остаться в одиночестве и играть по своим правилам", handler: nightAlone },
  ]);
}

function nightFriends() {
  state.respect += 2;
  updateStory(
`Ты знакомишься с несколькими арестантами. Они оценивают твою честность.

Честь: ${state.honor}
Уважение: ${state.respect}

Вдруг один из них предлагает тебе "решить вопрос" с должником. Что сделаешь?`,
    [
      { text: "Помочь другу, даже если придется нарушить правила", handler: helpFriend },
      { text: "Отказаться и остаться честным", handler: refuseHelp },
    ]);
}

function nightAlone() {
  state.honor += 1;
  updateStory(
`Ты решаешь идти своей дорогой, сохраняя честь и не вовлекаясь в грязные дела.

Честь: ${state.honor}
Уважение: ${state.respect}

Однако, одиночество не лучшее решение. Тебя замечают и вызывают на разговор с авторитетом.

Как отреагируешь?`,
    [
      { text: "Уважительно, стараясь не создавать проблем", handler: talkRespectfully },
      { text: "Отказать и показать, что не боишься", handler: talkDefiant },
    ]);
}

function helpFriend() {
  state.respect += 3;
  state.honor -= 2;
  updateStory(
`Ты помог другу. Теперь у тебя много уважения, но часть чести потеряна.

Честь: ${state.honor}
Уважение: ${state.respect}

Вскоре к тебе приходит выбор: сотрудничать с администрацией или нет.

Что выберешь?`,
    [
      { text: "Сотрудничать и попытаться облегчить свое положение", handler: cooperate },
      { text: "Отказаться и держаться кодекса", handler: refuseCooperate },
    ]);
}

function refuseHelp() {
  state.honor += 2;
  updateStory(
`Ты отказался нарушать свои принципы. Некоторые уважают тебя, но другие смотрят косо.

Честь: ${state.honor}
Уважение: ${state.respect}

Проходит время, тебе предлагают работать с администрацией.

Что сделаешь?`,
    [
      { text: "Согласиться ради шанса на свободу", handler: cooperate },
      { text: "Отказаться, не предавать свою честь", handler: refuseCooperate },
    ]);
}

function talkRespectfully() {
  state.respect += 1;
  updateStory(
`Авторитет оценил твою уважительность. У тебя появляется шанс получить покровительство.

Честь: ${state.honor}
Уважение: ${state.respect}

Тебя просят сделать маленькое "поручение" — взять долг и вернуть.

Что решишь?`,
    [
      { text: "Выполнить поручение", handler: doTask },
      { text: "Отказаться", handler: refuseTask },
    ]);
}

function talkDefiant() {
  state.honor += 2;
  state.respect -= 2;
  updateStory(
`Ты показал свою силу, но потерял уважение некоторых влиятельных личностей.

Честь: ${state.honor}
Уважение: ${state.respect}

Теперь тебе предлагают возможность сбежать из тюрьмы.

Что выберешь?`,
    [
      { text: "Попробовать сбежать", handler: escape },
      { text: "Остаться и продолжать жить по понятиям", handler: intro },
    ]);
}

function cooperate() {
  state.freedomChance += 2;
  updateStory(
`Ты пошел на сотрудничество. Система отмечает твоё поведение, что повышает шанс досрочного освобождения.

Честь: ${state.honor}
Уважение: ${state.respect}
Шанс свободы: ${state.freedomChance}

В конце срока ждёт последнее испытание — поведешь себя как порядочный человек или нет?`,
    [
      { text: "Сохранить честь до конца", handler: finalTest },
      { text: "Пойти на сделку и выслужиться", handler: betray },
    ]);
}

function refuseCooperate() {
  state.honor += 2;
  updateStory(
`Ты отказался от сотрудничества. Честь при тебе.

Честь: ${state.honor}
Уважение: ${state.respect}
Шанс свободы: ${state.freedomChance}

Конец срока близок. Проявишь порядочность в последний день?`,
    [
      { text: "Да, с честью", handler: finalTest },
      { text: "Нет, решил выжить любой ценой", handler: betray },
    ]);
}

function doTask() {
  state.respect += 2;
  state.honor -= 1;
  updateStory(
`Поручение выполнено — уважение растет, но честь слегка подмочена.

Честь: ${state.honor}
Уважение: ${state.respect}

Тебе дают шанс участвовать в криминальной группе.

Что сделаешь?`,
    [
      { text: "Вступить в группу", handler: joinGroup },
      { text: "Отказаться", handler: refuseGroup },
    ]);
}

function refuseTask() {
  state.honor += 1;
  updateStory(
`Ты отказался от грязной работы, сохранив честь.

Честь: ${state.honor}
Уважение: ${state.respect}

Теперь у тебя выбор — бороться честно или присоединиться к братве?`,
    [
      { text: "Бороться честно", handler: finalTest },
      { text: "Присоединиться к братве", handler: joinGroup },
    ]);
}

function escape() {
  if (state.respect > 5) {
    updateStory(
`Тебе удалось сбежать благодаря поддержке уважения среди арестантов!
Ты на свободе, но жизнь полна опасностей.

Играть заново?`,
      [
        { text: "Начать заново", handler: startGame }
      ]);
  } else {
    updateStory(
`План побега провален. Ты пойман и отправлен в карцер.

Честь: ${state.honor}
Уважение: ${state.respect}

Попробовать еще раз?`,
      [
        { text: "Начать заново", handler: startGame }
      ]);
  }
}

function joinGroup() {
  state.respect += 3;
  state.honor -= 3;
  updateStory(
`Ты вливаешься в криминальную группу. Уважение растет, но честь почти потеряна.

Честь: ${state.honor}
Уважение: ${state.respect}

Конец срока. Что выберешь — жизнь с честью или с выгодой?`,
    [
      { text: "С честью уходить не просто, но попробую", handler: finalTest },
      { text: "Жить по понятиям", handler: betray },
    ]);
}

function refuseGroup() {
  state.honor += 1;
  state.respect -= 1;
  updateStory(
`Ты отказался от братвы, потеряв немного уважения, но сохранил хотя бы честь.

Честь: ${state.honor}
Уважение: ${state.respect}

Последний день в тюрьме. Что выберешь?`,
    [
      { text: "Порядочность", handler: finalTest },
      { text: "Измену", handler: betray },
    ]);
}

function finalTest() {
  if (state.honor >= 6) {
    updateStory(
`Ты выходишь на свободу с поднятой головой. Порядочный арестант, которому есть чем гордиться!
Поздравляем — ты выиграл!

Играть заново?`,
    [
      { text: "Начать заново", handler: startGame }
    ]);
  } else {
    updateStory(
`Ты выходишь на свободу, но неся груз сомнительных поступков. Мир суров, и тебя ждут новые испытания.

Играть заново?`,
    [
      { text: "Начать заново", handler: startGame }
    ]);
  }
}

function betray() {
  state.respect += 1;
  state.honor -= 5;
  updateStory(
`Ты решил выживать любой ценой. Часть мира успешно завоевана, но цена слишком велика.

Честь: ${state.honor}
Уважение: ${state.respect}

Что дальше? Играть заново или сдаться?`,
    [
      { text: "Начать заново", handler: startGame }
    ]);
}

// Начать игру кнопкой
updateStory(
  `Добро пожаловать в игру "Блатной мир". Ты — порядочный арестант, который пытается выжить и сохранить честь в сложных условиях тюремного быта. Твои решения повлияют на судьбу. Жми "Начать", чтобы начать игру.`,
  [
    { text: "Начать", handler: startGame }
  ]);
</script>

</body>
</html>